<!-- 
  PAGE PRINCIPALE DU JEU
  Ce fichier contient tout ce qui est affich√© √† l'√©cran pour le joueur.
-->

<!-- Titre principal de la page -->
<h1>Jeu maux de passe</h1>

<!-- 
  CONTENEUR DU JEU 
  C'est la bo√Æte principale qui contient les cartes et les zones.
  "cdkDropListGroup" est une instruction magique qui dit √† l'ordinateur 
  que les √©l√©ments peuvent √™tre d√©plac√©s entre les listes de ce groupe.
-->
<div class="game-container" cdkDropListGroup>

    <!-- 
      ZONE DE GAUCHE : LA PIOCHE
      C'est ici que les cartes "Mot de passe" apparaissent au d√©but.
      [cdkDropListData]="cartes" lie cette zone √† notre liste "cartes" dans le code.
      (cdkDropListDropped)="drop($event)" dit quoi faire quand on l√¢che une carte ici.
    -->
    <div id="zone-cartes-mdp" class="zone" cdkDropList cdkDropListOrientation="mixed" [cdkDropListData]="cartes"
        (cdkDropListDropped)="drop($event)">

        <h2>Cartes mot de passe</h2>

        <!-- 
          BOUCLE (@for) : 
          Pour chaque carte dans notre liste "cartes", on affiche un composant <app-cartemdp>.
          C'est comme une photocopieuse qui cr√©e autant de cartes qu'on en a besoin.
        -->
        @for (carte of cartes; track carte) {
        <!-- "cdkDrag" signifie que cet √©l√©ment peut √™tre attrap√© et d√©plac√© √† la souris -->
        <app-cartemdp [texte]="carte" cdkDrag></app-cartemdp>
        }
    </div>

    <!-- 
      ZONE DE DROITE : LES ZONES DE DUR√âE
      C'est ici que le joueur doit d√©poser les cartes.
    -->
    <div id="zone-zones-duree">
        <h2>Zones de dur√©es</h2>

        <!-- 
          BOUCLE (@for) : Pour chaque zone de dur√©e d√©finie dans le code...
        -->
        @for (zone of zones; track zone.label) {

        <!-- 
          ZONE DE D√âP√îT INDIVIDUELLE
          Chaque dur√©e a sa propre petite zone o√π on peut l√¢cher une carte.
          [cdkDropListData]="zone.items" lie cette zone sp√©cifique au contenu de cette zone dans le code.
        -->
        <div class="drop-zone-slot" cdkDropList [cdkDropListData]="zone.items" (cdkDropListDropped)="drop($event)">

            <!-- Affiche l'√©tiquette de la dur√©e (ex: "1 jour", "3 mois") -->
            <app-zoneduree [duree]="zone.label"></app-zoneduree>

            <!-- 
              Si une carte a √©t√© d√©pos√©e ici, on l'affiche.
              Comme il ne peut y avoir qu'une carte par zone, cette boucle affichera 0 ou 1 carte.
            -->
            @for (item of zone.items; track item) {
            <app-cartemdp [texte]="item" cdkDrag></app-cartemdp>
            }
        </div>
        }
    </div>
</div>

<!-- 
  BOUTON VALIDER
  Quand on clique dessus ((click)="btnValider()"), √ßa lance la v√©rification des r√©ponses.
-->
<button (click)="btnValider()" id="btn-jeu-mdp">VALIDER</button>

<!-- 
  Lien vers le site de Hive Systems qui est la source des dur√©es estim√©es
-->
<br>
<p>
    Les dur√©es estim√©es sont d√©termin√©es par
    <a href="https://www.hivesystems.com/blog/are-your-passwords-in-the-green" target="_blank">Hive Systems</a>.
</p>

<!-- 
  GESTION DES POPUPS (Fen√™tres surgissantes)
  Ce bloc ne s'affiche que si variable "currentPopup" n'est pas 'NONE'.
-->
@if (currentPopup !== 'NONE') {
<div class="popup-overlay">
    <!-- Le contenu de la fen√™tre. On ajoute la classe "victory" si c'est une victoire pour faire joli. -->
    <div class="popup-content" [ngClass]="{'victory': currentPopup === 'VICTORY'}">

        <!-- SC√âNARIO 1 : LES R√àGLES DU JEU (Affich√© au d√©but) -->
        @if (currentPopup === 'RULES') {
        <h2>R√®gles du jeu</h2>
        <p>Bienvenue dans le jeu maux de passe !</p>
        <p>Votre objectif est d'associer chaque mot de passe √† sa dur√©e de craquage estim√©e.</p>
        <p>Glissez les cartes de gauche vers les zones correspondantes √† droite.</p>
        <button (click)="closePopup()" class="btn-popup">Commencer</button>
        }

        <!-- SC√âNARIO 2 : JEU INCOMPLET (Le joueur a cliqu√© sur Valider trop t√¥t) -->
        @if (currentPopup === 'INCOMPLETE') {
        <h2>Placement incomplet</h2>
        <p>Vous n'avez pas plac√© toutes les cartes.</p>
        <p>Veuillez associer chaque mot de passe √† une dur√©e avant de valider.</p>
        <button (click)="closePopup()" class="btn-popup">Continuer</button>
        }

        <!-- SC√âNARIO 3 : VICTOIRE (Tout est bon !) -->
        @if (currentPopup === 'VICTORY') {
        <div class="victory-icon">üéâ</div>
        <h2>F√©licitations !</h2>
        <p>Vous avez correctement class√© tous les mots de passe !</p>
        <div class="popup-actions">
            <!-- Bouton pour rejouer -->
            <button (click)="resetGame()" class="btn-popup">Nouvelle partie</button>
            <!-- Bouton pour aller voir les outils -->
            <button (click)="goToTools()" class="btn-popup secondary">Bo√Æte √† outils</button>
        </div>
        }

        <!-- SC√âNARIO 4 : D√âFAITE (Il y a des erreurs) -->
        @if (currentPopup === 'DEFEAT') {
        <h2>Dommage...</h2>
        <p>Il y a des erreurs dans votre classement.</p>
        <p>Ne vous d√©couragez pas, essayez encore !</p>
        <div class="popup-actions hidden-on-mobile"> <!-- Stack buttons vertically -->
            <button (click)="closePopup()" class="btn-popup">Continuer la partie</button>
            <button (click)="resetGame()" class="btn-popup destroy">Nouvelle partie</button>
        </div>
        }

    </div>
</div>
}